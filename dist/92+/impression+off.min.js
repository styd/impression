(t=>{const{document:e,IntersectionObserver:n,IntersectionObserverEntry:i}=t,r=e.currentScript,s=r.getAttribute("elements-selector")||".impression",o=r.getAttribute("visible-fraction")||.5,c=r.getAttribute("visible-fractioff")||0;if(n&&i&&"intersectionRatio"in i.prototype){const i=(t,e)=>{t.forEach((({target:t,isIntersecting:n,intersectionRatio:i})=>{const s=""==t.getAttribute("impression");n?(!s&&i>=o&&r(t),s&&i<=c&&(a(t),e.unobserve(t))):s&&(a(t),e.unobserve(t))}))},r=t=>{const e=new Event("impression");t.setAttribute("impression",""),t.dispatchEvent(e)},a=t=>{const e=new Event("impressioff");t.dispatchEvent(e),t.removeAttribute("impression")},v=new n(i,{threshold:[c,o]}),b=()=>{e.querySelectorAll(s).forEach((t=>{v.observe(t)}))};t.addEventListener?t.addEventListener("load",b,!0):t.attachEvent?t.attachEvent("onload",b):b()}})(window);