(e=>{const{document:t}=e,r=t.currentScript.getAttribute("elements-selector")||".impression",i=t.currentScript.getAttribute("visible-fraction")||.5,n=t.currentScript.getAttribute("visible-fractioff")||0;if("IntersectionObserver"in e&&"IntersectionObserverEntry"in e&&"intersectionRatio"in IntersectionObserverEntry.prototype){const e=(e,t)=>{e.forEach((({target:e,isIntersecting:r,intersectionRatio:c})=>{const b=""==e.getAttribute("impression");r?(!b&&c>=i&&s(e),b&&c<=n&&(o(e),t.unobserve(e))):b&&(o(e),t.unobserve(e))}))},s=e=>{const t=new Event("impression");e.setAttribute("impression",""),e.dispatchEvent(t)},o=e=>{const t=new Event("impressioff");e.dispatchEvent(t),e.removeAttribute("impression")},c=new IntersectionObserver(e,{threshold:[n,i]});t.querySelectorAll(r).forEach((e=>{c.observe(e)}))}})(window);